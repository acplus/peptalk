// Source file for PDBChain class



// Include files

#include "PDB.h"



PDBChain::
PDBChain(PDBMolecule *molecule, const char *name)
  : molecule(molecule),
    bbox(R3null_box)
{
  // Assign ID
  static int PDBnext_chain_id = 0;
  id = PDBnext_chain_id++;

  // Copy name
  if (name) strncpy(this->name, name, 4);
  else this->name[0] = '\0';

  // Insert chain into molecule
  if (molecule) molecule->chains.Insert(this);
}



PDBResidue *PDBChain::
FindResidue(const char *name, int sequence, int insertion_code) const
{
  // Find residue
  for (int i = 0; i < NResidues(); i++) {
    PDBResidue *residue = Residue(i);
    if (sequence != residue->Sequence()) continue;
    if (insertion_code != residue->InsertionCode()) continue;
    if (name) { if ((!residue->Name()) || (strcmp(name, residue->Name()))) continue; }
    else if (residue->Name()) continue;
    return residue;
  }
  return NULL;
}



